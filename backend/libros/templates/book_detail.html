{% extends 'utils/base.html' %}

{% block title %}{{ book.title }} - BookieWookie{% endblock %}

{% block content %}
<div class="detail-wrapper">
    {% if error %}
        <div class="error-message">
            <strong>‚ö†Ô∏è Error:</strong> {{ error }}
        </div>
    {% endif %}

    {% if book %}
        <nav class="breadcrumb">
            <a href="/">Inicio</a> / 
            <a href="javascript:history.back()">B√∫squeda</a> / 
            <span>{{ book.title|default:"Libro" }}</span>
        </nav>

        <div class="book-main-card">
            <div class="inicio-ficcion">
                <button class="agregar-btn" onclick="agregarABiblioteca()">
                    <span>‚≠ê</span>
                    <span>Agregar a Biblioteca</span>
                </button>
            </div>

            <!-- Book Header -->
            <div class="book-header">
                <!-- Cover -->
                <div class="book-cover-section">
                    {% if book.thumbnail %}
                        <img src="{{ book.thumbnail }}" alt="{{ book.title }}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="book-cover-placeholder" style="display: none;">
                            üìö
                        </div>
                    {% else %}
                        <div class="book-cover-placeholder">
                            üìö
                        </div>
                    {% endif %}
                </div>

                <!-- Info -->
                <div class="book-info-section">
                    <h1>{{ book.title|default:"Sin t√≠tulo" }}</h1>
                    
                    {% if book.authors %}
                        {% if book.authors.0 %}
                            <p class="book-author">Por {{ book.authors.0 }}</p>
                        {% elif book.authors %}
                            <p class="book-author">Por {{ book.authors|join:", " }}</p>
                        {% endif %}
                    {% else %}
                        <p class="book-author">Autor desconocido</p>
                    {% endif %}

                    <div class="book-description">
                        {% if book.description %}
                            {{ book.description|safe }}
                        {% else %}
                            <p style="color: #999; font-style: italic;">No hay descripci√≥n disponible para este libro.</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Detalles del libro -->
            <div class="detalles-section">
                <h2>Detalles del libro</h2>
                <div class="detalles-grid">
                    <div class="detalle-item">
                        <div class="detalle-label">G√©nero</div>
                        <div class="detalle-value">
                            {% if book.categories %}
                                {% if book.categories.0 %}
                                    {{ book.categories.0 }}
                                {% else %}
                                    {{ book.categories|join:", " }}
                                {% endif %}
                            {% else %}
                                N/A
                            {% endif %}
                        </div>
                    </div>
                    <div class="detalle-item">
                        <div class="detalle-label">A√±o de publicaci√≥n</div>
                        <div class="detalle-value">
                            {% if book.published_date %}
                                {{ book.published_date|slice:":4" }}
                            {% elif book.publishedDate %}
                                {{ book.publishedDate|slice:":4" }}
                            {% else %}
                                N/A
                            {% endif %}
                        </div>
                    </div>
                    <div class="detalle-item">
                        <div class="detalle-label">No. p√°ginas</div>
                        <div class="detalle-value">
                            {% if book.page_count %}
                                {{ book.page_count }}
                            {% elif book.pageCount %}
                                {{ book.pageCount }}
                            {% else %}
                                N/A
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="disponibilidad-section">
                <h2>Disponibilidad</h2>
                
                <div class="placeholder-box">
                    <p>üì¶ Informaci√≥n de disponibilidad y precios</p>
                    <p>Se mostrar√° pr√≥ximamente</p>
                </div>
            </div>
        </div>

        <div class="book-main-card">
            <div class="libros-relacionados-section">
                <h2>Libros relacionados</h2>
                
                <div class="placeholder-box" style="padding: 70px 20px;">
                    <p>üìö Recomendaciones personalizadas</p>
                    <p>Se mostrar√°n pr√≥ximamente</p>
                </div>
            </div>
        </div>
    {% else %}
        <div class="error-message">
            <strong>‚ö†Ô∏è Libro no encontrado</strong>
            <p>No se pudo cargar la informaci√≥n del libro solicitado.</p>
        </div>
    {% endif %}
</div>

<script>
function agregarABiblioteca() {
    alert('Funcionalidad de biblioteca en desarrollo üìö');
}
</script>
{% endblock %}