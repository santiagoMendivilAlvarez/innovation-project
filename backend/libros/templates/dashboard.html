{% extends 'utils/base.html' %}
{% load static %}

{% block title %}Dashboard - BookieWookie{% endblock %}

{% block content %}
<div class="main-container">
    
    <div class="hero-section">
        <h1 class="hero-title">Encuentra el mejor precio</h1>
        <p class="hero-subtitle">
            para cualquier libro que busques<br>
            Comparamos precios de los mejores sitios en l√≠nea de venta de libros para que encuentres y 
            compres libros al mejor precio disponible en el mercado.
        </p>
        
        <div class="search-section">
             <form class="search-form" method="GET" action="{% url 'book_search' %}" id="dashboardSearchForm">
                 <div class="search-input-container">
                     <input type="text" class="search-input-text" placeholder="¬øQu√© libro est√°s buscando?" name="search" value="{{ request.GET.search|default:'' }}" required>
                 </div>
                 <button type="submit" class="search-text-btn">Buscar libro</button>
             </form>
         </div>
    </div>


    <div class="stats-section">
        <div class="stat-card">
            <span class="stat-number">45,000+</span>
            <div class="stat-label">Libros disponibles</div>
        </div>
        <div class="stat-card">
            <span class="stat-number">$850M</span>
            <div class="stat-label">en ahorros</div>
            <div class="stat-subtitle">generados</div>
        </div>
        <div class="stat-card">
            <span class="stat-number">50+</span>
            <div class="stat-label">tiendas</div>
            <div class="stat-subtitle">comparadas</div>
        </div>
        <div class="stat-card">
            <span class="stat-number">24/7</span>
            <div class="stat-label">servicio</div>
            <div class="stat-subtitle">actualizado</div>
        </div>
    </div>

    <div class="features-section">
        <h2 class="features-title">¬øPor qu√© elegir BookieWookie?</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">üìö</div>
                <h3 class="feature-title">Comparaci√≥n inteligente</h3>
                <p class="feature-description">
                    Analizamos precios de m√∫ltiples tiendas para encontrar las mejores ofertas disponibles en tiempo real.
                </p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üîç</div>
                <h3 class="feature-title">B√∫squeda avanzada</h3>
                <p class="feature-description">
                    Encuentra exactamente lo que necesitas con filtros por categor√≠a, precio, autor y disponibilidad.
                </p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üìÖ</div>
                <h3 class="feature-title">Alertas de precio</h3>
                <p class="feature-description">
                    Recibe notificaciones cuando el libro que quieres baje de precio o est√© disponible con descuento.
                </p>
            </div>
        </div>
    </div>

    <!-- Explore Popular Books -->
    <div class="books-section">
        <div class="section-header">
            <h2 class="section-title">Explorar libros populares</h2>
            <a href="{% url "libros" %}" class="view-all-btn">Ver m√°s</a>
        </div>

        <div class="books-grid">
            {% if has_explore_books %}
                {% for book in explore_books %}
                    <a href="{% url 'book_detail' book.id %}?source=google" class="book-card-link">
                        <div class="book-card">
                            <div class="book-cover">
                                {% if book.thumbnail %}
                                    <img src="{{ book.thumbnail }}" alt="{{ book.title }}" onerror="this.style.display='none'; this.parentElement.innerHTML='üìñ';">
                                {% else %}
                                    üìñ
                                {% endif %}
                            </div>
                            <div class="book-info">
                                <h4 class="book-title">{{ book.title|truncatechars:50 }}</h4>
                                {% if book.authors %}
                                <p class="book-author">{{ book.authors|join:", "|truncatechars:40 }}</p>
                                {% endif %}
                                {% if book.categories %}
                                <span class="book-category">{{ book.categories.0 }}</span>
                                {% endif %}
                            </div>
                        </div>
                    </a>
                {% endfor %}
            {% else %}
                <div class="row d-flex">
                    <div class="col-md-12 col-lg-12 col-sm-12 text-center">
                        <h3>
                        No se pudieron cargar los libros en este momento
                        </h3>
                    </div>
                </div>
            {% endif %}

        </div>
    </div>
    {% if not request.user.is_authenticated %}
    <div class="cta-section">
        <h2 class="cta-title">¬øListo para empezar a ahorrar?</h2>
        <p class="cta-subtitle">
            √önete a miles de lectores que ya est√°n ahorrando en sus libros favoritos
        </p>
        <div class="cta-buttons">
            <a href="{% url 'register' %}" class="btn btn-filled">Registrarse</a>
            <a href="{% url 'login' %}" class="btn btn-filled">Iniciar Sesi√≥n</a>
        </div>
    </div>
    {% endif %}
 </div>
 {% if request.user.is_authenticated %}
 {% include 'chatbot.html' %}
 {% endif %}
 

 {% endblock %}